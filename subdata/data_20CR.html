
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>The 20th Century Reanalysis: IRData.twcr &#8212; An API for accessing synoptic-timescale reanalyis data</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The CERA-20C reanalysis: IRData.cera20c" href="data_cera20c.html" />
    <link rel="prev" title="Installation" href="../install.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="data_cera20c.html" title="The CERA-20C reanalysis: IRData.cera20c"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../install.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">IRData</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/UK.GS1987.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">The 20th Century Reanalysis: IRData.twcr</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pre-release-version-3">Pre-release version 3</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_cera20c.html">The CERA-20C reanalysis: IRData.cera20c</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_era5.html">The ERA-5 reanalysis: IRData.era5</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Authors and acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uses.html">Uses of this package</a></li>
</ul>
<h3><a href="https://github.com/philip-brohan/IRData">Get the source code</a></h3>

<a href="https://github.com/philip-brohan/IRData"
           rel="nofollow">Github source repository</a>

<h3>Found a bug, or have a suggestion?</h3>

Please <a href="https://github.com/philip-brohan/IRData/issues/new">raise an issue</a>.
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-IRData.twcr">
<span id="the-20th-century-reanalysis-irdata-twcr"></span><h1>The 20th Century Reanalysis: IRData.twcr<a class="headerlink" href="#module-IRData.twcr" title="Permalink to this headline">¶</a></h1>
<p>This package retrieves and loads data from the <a class="reference external" href="https://www.esrl.noaa.gov/psd/data/20thC_Rean/">Twentieth Century Reanalysis (20CR)</a>.</p>
<p>It retrieves the data from the <a class="reference external" href="http://portal.nersc.gov/project/20C_Reanalysis/">20CR portal</a> at <a class="reference external" href="http://www.nersc.gov">NERSC</a>.</p>
<p>At the moment, only version ‘2c’ of 20CR is supported for public use. There is limited support for the pre-release of version 3 - versions ‘4.5.*’ - see below.</p>
<p>Only hourly data is supported (no daily or monthly averages) for 5 surface variables:</p>
<ul class="simple">
<li>Mean-sea-level pressure: ‘mslp’</li>
<li>2m air temperature: ‘air.2m’</li>
<li>Precipitation rate: ‘prate’</li>
<li>10m meridional wind: ‘uwnd.10m’</li>
<li>10m zonal wind: ‘vwnd.10m’</li>
</ul>
<p>Data retrieved is stored in directory $SCRATCH/20CR - the ‘SCRATCH’ environment variable must be set.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">IRData.twcr</span> <span class="kn">as</span> <span class="nn">twcr</span>
<span class="n">twcr</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;prate&#39;</span><span class="p">,</span>
           <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1987</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span>
           <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Will retrieve precipitation rate data for the selected date. 20CR2c data is fetched in one-calendar-year blocks, so this will retrieve data for the whole of 1987. The retrieval is slow, as the data has to be fetched from NERSC, but the retrieval is only run if necessary - if that year’s data has been previously fetched and is already on local disc, the fetch command will detect this and return instantly.</p>
<p>Once the data has been fetched,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span><span class="o">=</span><span class="n">twcr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;prate&#39;</span><span class="p">,</span>
             <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1987</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span>
             <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will then load the precipitation rates at quarter past 3pm on March 12 1987 from the retrieved dataset as an <a class="reference external" href="https://scitools.org.uk/iris/docs/latest/iris/iris/cube.html#iris.cube.Cube" title="(in Iris v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code></a>. Note that as 20CR only provides data at 6-hourly or 3-hourly intervals, the value for 3:15pm will be interpolated between the outputs (to get uninterpolated data, only call load for times when 20CR has output). Also, as 20CR2c is an ensemble dataset, the result will include all 56 ensemble members.</p>
<p>Observations files are also available. They can be fetched with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">twcr</span><span class="o">.</span><span class="n">fetch_observations</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1987</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span>
                        <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Observations are also fetched in one-calendar-year blocks, so this will retrieve observations (from NERSC) for the whole of 1987. Again, the retrieval is only run if necessary - if that year’s data has been previously fetched and is already on local disc, the fetch command will detect this and return instantly.</p>
<p>Once the observations have been fetched, load all the observations valid between two times with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">o</span><span class="o">=</span><span class="n">twcr</span><span class="o">.</span><span class="n">load_observations</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1987</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
                         <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1987</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">),</span>
                         <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It’s also possible to load all the observations associated with a particular reanalysis field. 20CR assimilates observations every 6-hours, so there is one observations file for each 6-hourly assimilation run. Load all the observations available to the assimilation run for 12 noon on March 12 1987 (as a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>) with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">o</span><span class="o">=</span><span class="n">twcr</span><span class="o">.</span><span class="n">load_observations_1file</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1987</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span>
                               <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>That’s only possible for times that match an assimilation time (hour=0,6,12,18). For in-between times (interpolated fields), load all the observations contributing to the field with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">o</span><span class="o">=</span><span class="n">twcr</span><span class="o">.</span><span class="n">load_observations_fortime</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1987</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span>
                                 <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This gets all the observations from each field used in the interpolation, and assigns a weight to each one - the same as the weight used in interpolating the fields.</p>
<div class="section" id="pre-release-version-3">
<h2>Pre-release version 3<a class="headerlink" href="#pre-release-version-3" title="Permalink to this headline">¶</a></h2>
<p>Version numbers beginning ‘4.5.’ (mostly ‘4.5.1’ and ‘4.5.2’) are the pre-release data for 20CRv3 and all the functions described above will work in the same way, with the <em>major</em> caveat that the data are not yet released, so you can’t just ‘fetch’ them. To get proto-v3 data, first <a class="reference external" href="https://oldweather.github.io/20CRv3-diagnostics/extract_data/extract_data.html">create the data files at NERSC</a> and then fetch them as with 2c, except you will be downloading the data by ssh. This means you will need to <a class="reference external" href="http://www.nersc.gov/users/connecting-to-nersc/connecting-with-ssh/">setup your NERSC account to support passwordless ssh access from your local machine</a> and add your NERSC account name to the fetch command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">IRData.twcr</span> <span class="kn">as</span> <span class="nn">twcr</span>
<span class="n">twcr</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;prate&#39;</span><span class="p">,</span>
           <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1987</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span>
           <span class="n">version</span><span class="o">=</span><span class="s1">&#39;4.5.1&#39;</span><span class="p">,</span>
           <span class="n">user</span><span class="o">=</span><span class="s1">&#39;pbrohan&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that proto-v3 data is fetched in 1-month blocks (rather than 1-year as for 2c).
All the ‘load’ functions then work exactly as for 2c.</p>
<p>Note: NERSC is soon to enforce multi-factor authentication which will mess this up. Some changes will be required.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="function">
<dt id="IRData.twcr.fetch">
<code class="descclassname">IRData.twcr.</code><code class="descname">fetch</code><span class="sig-paren">(</span><em>variable</em>, <em>dtime</em>, <em>height=None</em>, <em>level=None</em>, <em>ilevel=None</em>, <em>version='none'</em>, <em>user='pbrohan'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/IRData/twcr/fetch.html#fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#IRData.twcr.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get data for one variable, from the 20CR archive at NERSC.</p>
<p>Data wil be stored locally in directory $SCRATCH/20CR, to be retrieved by <a class="reference internal" href="#IRData.twcr.load" title="IRData.twcr.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a>. If the local file that would be produced already exists, this function does nothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Variable to fetch (e.g. ‘prmsl’).</li>
<li><strong>dtime</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>) – Date and time to get data for.</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Height above ground (m) for 3d variables. Only used in v3. Variable must be in 20CR output at that exact height (no interpolation). Defaults to None - appropriate for 2d variables.</li>
<li><strong>level</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Pressure level (hPa) for 3d variables. Only used in v3. Variable must be in 20CR output at that exact pressure level (no interpolation). Defaults to None - appropriate for 2d variables.</li>
<li><strong>ilevel</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Isentropic level (K) for 3d variables. Only used in v3. Variable must be in 20CR output at that exact pressure level (no interpolation). Defaults to None - appropriate for 2d variables.</li>
<li><strong>version</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – 20CR version to retrieve data for.</li>
<li><strong>user</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – NERSC userid to use in retrieval. Only needed for v3-preliminary data. Defaults to ‘pbrohan’. This should be your NERSC username.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StandardError</span></code> – If version is not a supported value.</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</dd></dl>

<dl class="function">
<dt id="IRData.twcr.fetch_observations">
<code class="descclassname">IRData.twcr.</code><code class="descname">fetch_observations</code><span class="sig-paren">(</span><em>dtime</em>, <em>version='none'</em>, <em>user='pbrohan'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/IRData/twcr/observations.html#fetch_observations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#IRData.twcr.fetch_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Get observations from the 20CR archive at NERSC.</p>
<p>Data wil be stored locally in directory $SCRATCH/20CR, to be retrieved by <a class="reference internal" href="#IRData.twcr.load_observations" title="IRData.twcr.load_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_observations()</span></code></a>. If the local files that would be produced already exists, this function does nothing.</p>
<p>For 20CR version 2c, the data is retrieved in calendar year blocks, and the ‘month’ and ‘day’ arguments are ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dtime</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>) – Date and time to get observations for.</li>
<li><strong>version</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – 20CR version to retrieve data for.</li>
<li><strong>user</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – NERSC userid to use in retrieval. Only needed for v3-preliminary data. Defaults to ‘pbrohan’. This should be your NERSC username.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Will retrieve the data for the year of the given date-time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StandardError</span></code> – If version is not a supported value.</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</dd></dl>

<dl class="function">
<dt id="IRData.twcr.load">
<code class="descclassname">IRData.twcr.</code><code class="descname">load</code><span class="sig-paren">(</span><em>variable</em>, <em>dtime</em>, <em>height=None</em>, <em>level=None</em>, <em>ilevel=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/IRData/twcr/load.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#IRData.twcr.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load requested data from disc, interpolating if necessary.</p>
<p>Data must be available in directory $SCRATCH/20CR, previously retrieved by <a class="reference internal" href="#IRData.twcr.fetch" title="IRData.twcr.fetch"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Variable to fetch (e.g. ‘prmsl’)</li>
<li><strong>dtime</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>) – Date and time to load data for.</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Height above ground (m) for 3d variables. Only used in v3. Variable must be in 20CR output at that exact height (no interpolation). Defaults to None - appropriate for 2d variables.</li>
<li><strong>level</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Pressure level (hPa) for 3d variables. Only used in v3. Variable must be in 20CR output at that exact pressure level (no interpolation). Defaults to None - appropriate for 2d variables.</li>
<li><strong>ilevel</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Isentropic level (K) for 3d variables. Only used in v3. Variable must be in 20CR output at that exact pressure level (no interpolation). Defaults to None - appropriate for 2d variables.</li>
<li><strong>version</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – 20CR version to load data from.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Global field of variable at time.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://scitools.org.uk/iris/docs/latest/iris/iris/cube.html#iris.cube.Cube" title="(in Iris v2.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p>Note that 20CR data is only output every 6 hours (v2c prmsl) or 3 hours, so if hour%3!=0, the result may be linearly interpolated in time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StandardError</span></code> – Version number not supported, or data not on disc - see <a class="reference internal" href="#IRData.twcr.fetch" title="IRData.twcr.fetch"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch()</span></code></a></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</dd></dl>

<dl class="function">
<dt id="IRData.twcr.load_observations">
<code class="descclassname">IRData.twcr.</code><code class="descname">load_observations</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>version='none'</em>, <em>user='pbrohan'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/IRData/twcr/observations.html#load_observations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#IRData.twcr.load_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Load observations from disc, for the selected period</p>
<p>Data must be available in directory $SCRATCH/20CR, previously retrieved by <a class="reference internal" href="#IRData.twcr.fetch" title="IRData.twcr.fetch"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>) – Get observations at or after this time.</li>
<li><strong>end</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>) – Get observations before this time.</li>
<li><strong>version</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – 20CR version to load data from.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dataframe of observations.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StandardError</span></code> – Version number not supported, or data not on disc - see <a class="reference internal" href="#IRData.twcr.fetch_observations" title="IRData.twcr.fetch_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_observations()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</dd></dl>

<dl class="function">
<dt id="IRData.twcr.load_observations_1file">
<code class="descclassname">IRData.twcr.</code><code class="descname">load_observations_1file</code><span class="sig-paren">(</span><em>dtime</em>, <em>version='none'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/IRData/twcr/observations.html#load_observations_1file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#IRData.twcr.load_observations_1file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load observations from disc, that were used in the assimilation run at the time specified.</p>
<p>Data must be available in directory $SCRATCH/20CR, previously retrieved by <a class="reference internal" href="#IRData.twcr.fetch_observations" title="IRData.twcr.fetch_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_observations()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dtime</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Date and time of assimilation run.</li>
<li><strong>version</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – 20CR version to load data from.</li>
<li><strong>user</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – NERSC userid to use in retrieval. Only needed for v3-preliminary data. Defaults to ‘pbrohan’. This should be your NERSC username.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dataframe of observations.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StandardError</span></code> – Version number not supported, or data not on disc - see <a class="reference internal" href="#IRData.twcr.fetch_observations" title="IRData.twcr.fetch_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_observations()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</dd></dl>

<dl class="function">
<dt id="IRData.twcr.load_observations_fortime">
<code class="descclassname">IRData.twcr.</code><code class="descname">load_observations_fortime</code><span class="sig-paren">(</span><em>v_time</em>, <em>version='none'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/IRData/twcr/observations.html#load_observations_fortime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#IRData.twcr.load_observations_fortime" title="Permalink to this definition">¶</a></dt>
<dd><p>Load observations from disc, that contribute to fields ata given time</p>
<p>Data must be available in directory $SCRATCH/20CR, previously retrieved by <a class="reference internal" href="#IRData.twcr.fetch" title="IRData.twcr.fetch"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch()</span></code></a>.</p>
<p>At the times when assimilation takes place, all the observations used at that time are provided by <a class="reference internal" href="#IRData.twcr.load_observations_1file" title="IRData.twcr.load_observations_1file"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_observations_1file()</span></code></a> - this function serves the same function, but for intermediate times, where fields are obtained by interpolation. It gets all the observations from each field used in the interpolation, and assigns a weight to each one - the same as the weight used in interpolating the fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>v_time</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>) – Get observations associated with this time.</li>
<li><strong>version</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – 20CR version to load data from.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">same as from <a class="reference internal" href="#IRData.twcr.load_observations" title="IRData.twcr.load_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_observations()</span></code></a>, except with aded column ‘weight’ giving the weight of each observation at the given time.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">StandardError</span></code> – Version number not supported, or data not on disc - see <a class="reference internal" href="#IRData.twcr.fetch_observations" title="IRData.twcr.fetch_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_observations()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="data_cera20c.html" title="The CERA-20C reanalysis: IRData.cera20c"
             >next</a> |</li>
        <li class="right" >
          <a href="../install.html" title="Installation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">IRData</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>